{% extends 'layout.html' %}

{% block content %}
    <h1 class="mb-4">{{ 'Edit Client' if is_edit else 'Add Client' }}</h1>
    <form method="post" action="" class="needs-validation" novalidate>
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="name" class="form-label">Name</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ client.name if client else '' }}" required>
                <div class="invalid-feedback">Please enter the client's name.</div>
            </div>
            <div class="col-md-6">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email" value="{{ client.email if client else '' }}" required>
                <div class="invalid-feedback">Please enter a valid email.</div>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="phone" class="form-label">Phone</label>
                <input type="text" class="form-control" id="phone" name="phone" value="{{ client.phone if client else '' }}">
            </div>
            <div class="col-md-3">
                <label for="status" class="form-label">Status</label>
                <select class="form-select" id="status" name="status">
                    {% set current_status = client.status if client else 'Lead' %}
                    <option value="Lead"{% if current_status=='Lead' %} selected{% endif %}>Lead</option>
                    <option value="Active"{% if current_status=='Active' %} selected{% endif %}>Active</option>
                    <option value="Inactive"{% if current_status=='Inactive' %} selected{% endif %}>Inactive</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="follow_up_date" class="form-label">Follow-up Date</label>
                <input type="date" class="form-control" id="follow_up_date" name="follow_up_date" value="{{ client.follow_up_date if client and client.follow_up_date else '' }}">
            </div>
        </div>
        <div class="mb-3">
            <label for="notes" class="form-label">Notes</label>
            <textarea class="form-control" id="notes" name="notes" rows="4">{{ client.notes if client else '' }}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">{{ 'Update' if is_edit else 'Create' }}</button>
        <a href="/clients" class="btn btn-secondary ms-2">Cancel</a>
    </form>

    <script>
        // Enable Bootstrap's client-side validation
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }
                        form.classList.add('was-validated')
                    }, false)
                })
        })();
    </script>
{% endblock %}